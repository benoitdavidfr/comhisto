title: comhisto - référentiel de l'historique des communes
path: /yamldoc/pub/comhisto
doc: |
  Construction d'un référentiel de l'historique des communes depuis le 1er janvier 1943.
  Restructuration du code produit dans rpicom, renommage du projet.
  Résultats:
    - historique des codes Insee -> insee/histov.yaml, son schéma et sa doc
    - fichier CSV permettant de convertir un code historique en un code Insee 2020, avec les champs suivants
      sr: 's' ou 'r'
      cinsee: code Insee ayant existé
      debut: date de début sous la forme AAAA-MM-DD
      fin: date de fin sous la forme AAAA-MM-DD ou null
      nom: nom associé
      s2020p: égalité (=) ou inclusion stricte (<) / commune simple du COG2020
      s2020c: code Insee d'une commune simple du COG2020
      r2020p: égalité (=) ou inclusion stricte (<) / entité rattachée du COG2020
      r2020c: évt. code Insee d'une entité rattachée du COG2020
    - fichier SIG permettant de géocoder n'importe quel code Insee, avec les champs suivants
      sr: 's' ou 'r'
      cinsee: code Insee ayant existé
      debut: date de début sous la forme AAAA-MM-DD
      fin: date de fin sous la forme AAAA-MM-DD ou null
      nom: nom associé
      géo: multi-ploygone associé
      
  Les étapes:
    1ère étape(insee):
      - à partir des données de mouvements Insee et de l'état au 1/1/2020, produire un document Yaml facile à consulter (par un humain
        et une machine) et à exploiter (par une machine) de l'historique de chaque code Insee
      - corriger ces données des incohérences constatées et de quelques erreurs flagrantes
      - ajuster à la marge au périmètre choisi (a priori Métropole + DOM, par la suite évent. extension à StBarth, StMartin, StP&M)
      - le résultat est un document histov.yaml, son schéma dans exhisto.yaml et la doc dans README.md
    2ème étape(zones):
      - en utilisant la topologie définie par l'Insee restructurée histov.yaml produire un document Yaml des zones
      - une zone correspond aux différentes versions ayant même extension géographique
      - la définition des zones inclus la relation d'inclusion entre elles
      - (gérer complètement les transferts entre commmunes dans un second temps)
    3ème étape(pgis):
      - définir le schéma PostGis de l'historique par code et des zones
      - charger l'historique par code et les zones dans PostGis
    4ème étape(ign):
      - charger dans PostGis les données AE2020COG d'IGN
      - à partir de ces données produire dans PostGis une couche géo. cohérente des entités administratives pour 2020
      - construire l'ensemble des limites entre entités et avec l'extérieur
      - affecter à chaque limite une géométrie généralisée avec une résolution de 100m (3 décimales)
      - affecter à chaque entité un multi-polygone généralisé
    5ème étape(Wikipédia):
      - compléter AE2020COG par la localisation ponctuelle (chef-lieu) des entités rattachées valides au 1/1/2020 et des entités abrogées
      - ces infos sont issues d'une part de Wikipedia et d'autre part du Géoportail
    6ème étape(géoZones):
      - affecter aux zones valides leur extension géographique en utilisant les géométries généralisées à partir de AE2020COG
      - (en option utiliser les anciennes versions IGN du COG pour affecter aux zones récentes leur extension géographique)
      - affecter à chaque zone la localisation ponctuelle de son chef-lieu
      - à chaque zone qui n'a pas d'extension géographique lui en associer une construite par l'algo de Voronoi
    7ème étape(expo):
      - construire le dispositif d'exposition fondé sur
        - une API REST d'accès aux historiques par code, aux versions et aux zones avec leur caraactéristiques géographiques
        - une utilisation de l'info dans QGis en accédant à l'information dans PostGis
      - produire la documentation d'utilisation
    8ème étape:
      - définir des cas d'usage
journal: |
  8/7/2020:
    - création à la suite de rpicom pour réécrire le code
submodules:
  - /yamldoc/pub/comhisto/data
  - /yamldoc/pub/comhisto/insee
  - /yamldoc/pub/comhisto/zones
  - /yamldoc/pub/comhisto/ign
phpScripts:
  #- /yamldoc/pub/comhisto/index.php
phpIncludes:
htmlFiles:
